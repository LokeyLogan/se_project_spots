!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);o&&(o.textContent=""),t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{t&&((e=>e.some((e=>!e.validity.valid)))(e)?((e,t)=>{e&&(e.disabled=!0,e.classList.add(t.inactiveButtonClass))})(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass)))};var n=e+"d3610e9c6dce3cb370d8.svg",a=e+"d38272e02bb4f1ab1c37.svg",c=e+"40608da7369d39bc1077.svg",l=e+"dba18798529f242c4c6d.svg",s=e+"d73f076c46eb5467f5fc.svg";document.querySelector(".header__logo").src=n,document.querySelector(".profile__pencil-icon").src=s,document.querySelector(".profile__edit-btn img").src=a,document.querySelector(".profile__add-btn img").src=c,document.querySelectorAll(".modal__close-btn img").forEach((e=>{e.src=l}));const d=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"b11e468b-3f59-4efb-985e-f8545b79cf07","Content-Type":"application/json"}}),i=document.querySelector(".profile__edit-btn"),u=document.querySelector(".profile__add-btn"),m=document.querySelector(".profile__avatar-btn"),_=document.querySelector(".profile__name"),f=document.querySelector(".profile__description"),p=document.querySelector(".profile__avatar"),v=document.querySelector("#edit-profile-modal"),y=document.querySelector("#avatar-modal"),b=document.querySelector("#add-card-modal"),S=document.querySelector("#preview-modal"),h=document.forms["edit-profile"],q=v.querySelector("#profile-name-input"),E=v.querySelector("#profile-description-input"),g=document.forms.card__form,k=g.querySelector(".modal__submit-btn"),C=b.querySelector("#add-card-name-input"),L=b.querySelector("#add-card-link-input"),A=S.querySelector(".modal__image"),U=S.querySelector(".modal__caption"),x=document.querySelector("#card-template"),I=document.querySelector(".cards__list");function $(e){e.classList.add("modal_opened"),document.addEventListener("keydown",P)}function j(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",P)}function P(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&j(e)}}function B(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=function(e){const t=x.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",(()=>{n.classList.toggle("card__like-button-liked")})),o.addEventListener("click",(()=>{$(S),A.src=e.link,A.alt=e.name,U.textContent=e.name})),a.addEventListener("click",(()=>{t.remove()})),t}(e);I[t](r)}document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>j(t)))})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&j(e)}))})),i.addEventListener("click",(()=>{q.value=_.textContent,E.value=f.textContent,((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n.forEach((o=>r(e,o,t))),o(n,a,t)})(h,t),$(v)})),u.addEventListener("click",(()=>$(b))),m.addEventListener("click",(()=>$(y))),h.addEventListener("submit",(function(e){e.preventDefault();const t=q.value,r=E.value;d.editUserInfo({name:t,about:r}).then((e=>{_.textContent=e.name,f.textContent=e.about,j(v)})).catch((e=>console.error("âŒ Error updating user:",e)))})),g.addEventListener("submit",(function(e){e.preventDefault();const t={name:C.value.trim(),link:L.value.trim()};t.name&&t.link?(B(t,"prepend"),g.reset(),k.disabled=!0,j(b)):alert("Please enter both a name and a valid image URL.")})),d.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{B({name:e.name,link:e.link},"append")})),p.src=r.avatar,_.textContent=r.name,f.textContent=r.about})).catch((e=>{console.error("Failed to load cards or user info from API:",e)})),(e=>{document.querySelectorAll(e.formSelector).forEach((t=>((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);o(n,a,t),n.forEach((e=>{e.addEventListener("input",(()=>{((e,t)=>{e.validity.valid?r(e.form,e,t):((e,t,r,o)=>{const n=e.querySelector(`#${t.id}-error`);n&&(n.textContent=r),t.classList.add(o.inputErrorClass)})(e.form,e,e.validationMessage,t)})(e,t),o(n,a,t)}))}))})(t,e)))})(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1pQixFQUFZcUcsTUFBTUMsS0FDdEIvRyxFQUFZeUIsaUJBQWlCakMsRUFBU0UsZ0JBRWxDZ0IsRUFBZ0JWLEVBQVlHLGNBQ2hDWCxFQUFTRyxzQkFHWGEsRUFBa0JDLEVBQVdDLEVBQWVsQixHQUU1Q2lCLEVBQVVpQixTQUFTekIsSUFDakJBLEVBQWFpRixpQkFBaUIsU0FBUyxLQXpEaEIrQyxFQUFDaEksRUFBY1QsS0FDbkNTLEVBQWFZLFNBQVNDLE1BUXpCZixFQUFlRSxFQUFhaUksS0FBTWpJLEVBQWNULEdBckI3QjJJLEVBQUNuSSxFQUFhQyxFQUFjbUksRUFBYzVJLEtBQy9ELE1BQU1VLEVBQWVGLEVBQVlHLGNBQWMsSUFBSUYsRUFBYUcsWUFDNURGLElBQWNBLEVBQWFHLFlBQWMrSCxHQUM3Q25JLEVBQWFLLFVBQVVZLElBQUkxQixFQUFTSyxnQkFBZ0IsRUFXbERzSSxDQUNFbEksRUFBYWlJLEtBQ2JqSSxFQUNBQSxFQUFhb0ksa0JBQ2I3SSxFQUlKLEVBZ0RJeUksQ0FBbUJoSSxFQUFjVCxHQUNqQ2dCLEVBQWtCQyxFQUFXQyxFQUFlbEIsRUFBUyxHQUNyRCxHQUNGLEVBS2dDd0ksQ0FBaUJoSSxFQUFhUixJQUFVLEVFMEc1RThJLENBQWlCOUksRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIHNldHRpbmdzKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlmIChlcnJvckVsZW1lbnQpIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaWYgKGVycm9yRWxlbWVudCkgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWxlbWVudCwgc2V0dGluZ3MpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGlucHV0RWxlbWVudC5mb3JtLFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgc2V0dGluZ3NcclxuICAgICk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudC5mb3JtLCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PlxyXG4gIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpID0+IHtcclxuICBpZiAoIWJ1dHRvbkVsZW1lbnQpIHJldHVybjtcclxuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKSA9PiB7XHJcbiAgaWYgKCFidXR0b25FbGVtZW50KSByZXR1cm47XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICk7XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncylcclxuICApO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lciA9IChmb3JtRWxlbWVudCwgc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICk7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCwgc2V0dGluZ3MpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4gc2V0RXZlbnRMaXN0ZW5lcihmb3JtRWxlbWVudCwgc2V0dGluZ3MpKTtcclxufTtcclxuXHJcbmV4cG9ydCB7IHJlc2V0VmFsaWRhdGlvbiB9O1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHNldHRpbmdzLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5cclxuLy8gSW1hZ2VzXHJcbmltcG9ydCBhdmF0YXJJbWcgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XHJcbmltcG9ydCBsb2dvSW1nIGZyb20gXCIuLi9pbWFnZXMvTG9nb18oMSkuc3ZnXCI7XHJcbmltcG9ydCBwZW5jaWxJY29uIGZyb20gXCIuLi9pbWFnZXMvR3JvdXBfMi5zdmdcIjtcclxuaW1wb3J0IHBsdXNJY29uIGZyb20gXCIuLi9pbWFnZXMvR3JvdXBfMjYuc3ZnXCI7XHJcbmltcG9ydCBjbG9zZUljb24gZnJvbSBcIi4uL2ltYWdlcy9Hcm91cF8yNy5zdmdcIjtcclxuaW1wb3J0IGF2YXRhclBlbmNpbEljb24gZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXJfcGVuY2lsLnN2Z1wiO1xyXG5cclxuLy8gSW5qZWN0IGltYWdlc1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbG9nb1wiKS5zcmMgPSBsb2dvSW1nO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BlbmNpbC1pY29uXCIpLnNyYyA9IGF2YXRhclBlbmNpbEljb247XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG4gaW1nXCIpLnNyYyA9IHBlbmNpbEljb247XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0biBpbWdcIikuc3JjID0gcGx1c0ljb247XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0biBpbWdcIikuZm9yRWFjaCgoaW1nKSA9PiB7XHJcbiAgaW1nLnNyYyA9IGNsb3NlSWNvbjtcclxufSk7XHJcblxyXG4vLyBBUEkgaW5pdFxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiMTFlNDY4Yi0zZjU5LTRlZmItOTg1ZS1mODU0NWI3OWNmMDdcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8gRE9NIEVsZW1lbnRzXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgY2FyZE1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGVcIl07XHJcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLW5hbWUtaW5wdXRcIlxyXG4pO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbiA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJjYXJkX19mb3JtXCJdO1xyXG5jb25zdCBjYXJkU3VibWl0QnV0dG9uID0gY2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xyXG5cclxuY29uc3QgcHJldmlld01vZGFsSW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuLy8gTW9kYWwgb3Blbi9jbG9zZVxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY0tleSk7XHJcbn1cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjS2V5KTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVFc2NLZXkoZXZlbnQpIHtcclxuICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBvcGVuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGlmIChvcGVuTW9kYWwpIGNsb3NlTW9kYWwob3Blbk1vZGFsKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIENhcmQgcmVuZGVyaW5nXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmROYW1lRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgY29uc3QgY2FyZEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gIGNhcmROYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuICBjYXJkSW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbi1saWtlZFwiKTtcclxuICB9KTtcclxuXHJcbiAgY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJldmlld01vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICB9KTtcclxuXHJcbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtLCBtZXRob2QgPSBcInByZXBlbmRcIikge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgY2FyZHNMaXN0W21ldGhvZF0oY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG4vLyBGb3JtIGhhbmRsZXJzXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7XHJcbiAgICBuYW1lOiBjYXJkTmFtZUlucHV0LnZhbHVlLnRyaW0oKSxcclxuICAgIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUudHJpbSgpLFxyXG4gIH07XHJcblxyXG4gIGlmICghaW5wdXRWYWx1ZXMubmFtZSB8fCAhaW5wdXRWYWx1ZXMubGluaykge1xyXG4gICAgYWxlcnQoXCJQbGVhc2UgZW50ZXIgYm90aCBhIG5hbWUgYW5kIGEgdmFsaWQgaW1hZ2UgVVJMLlwiKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHJlbmRlckNhcmQoaW5wdXRWYWx1ZXMsIFwicHJlcGVuZFwiKTtcclxuICBjYXJkRm9ybS5yZXNldCgpO1xyXG4gIGNhcmRTdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgbmV3TmFtZSA9IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZTtcclxuICBjb25zdCBuZXdBYm91dCA9IGVkaXRNb2RhbERlc2NyaXB0aW9uLnZhbHVlO1xyXG5cclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oeyBuYW1lOiBuZXdOYW1lLCBhYm91dDogbmV3QWJvdXQgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIHVwZGF0aW5nIHVzZXI6XCIsIGVycikpO1xyXG59XHJcblxyXG4vLyBFdmVudCBsaXN0ZW5lcnNcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2UtYnRuXCIpLmZvckVhY2goKGJ1dHRvbikgPT4ge1xyXG4gIGNvbnN0IG1vZGFsID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG1vZGFsKSk7XHJcbn0pO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKS5mb3JFYWNoKChtb2RhbCkgPT4ge1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudC50YXJnZXQgPT09IG1vZGFsKSBjbG9zZU1vZGFsKG1vZGFsKTtcclxuICB9KTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uLnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIHJlc2V0VmFsaWRhdGlvbihlZGl0Rm9ybUVsZW1lbnQsIHNldHRpbmdzKTtcclxuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuY2FyZE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwoY2FyZE1vZGFsKSk7XHJcbmF2YXRhck1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwoYXZhdGFyRWRpdE1vZGFsKSk7XHJcbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcclxuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuXHJcbi8vIEluaXRpYWwgZGF0YSBsb2FkXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW2NhcmRzLCB1c2VyXSkgPT4ge1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKHsgbmFtZTogY2FyZC5uYW1lLCBsaW5rOiBjYXJkLmxpbmsgfSwgXCJhcHBlbmRcIik7XHJcbiAgICB9KTtcclxuICAgIGF2YXRhckltYWdlLnNyYyA9IHVzZXIuYXZhdGFyO1xyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBjYXJkcyBvciB1c2VyIGluZm8gZnJvbSBBUEk6XCIsIGVycik7XHJcbiAgfSk7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsImRvY3VtZW50Iiwic3JjIiwibG9nb0ltZyIsImF2YXRhclBlbmNpbEljb24iLCJwZW5jaWxJY29uIiwicGx1c0ljb24iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImltZyIsImNsb3NlSWNvbiIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImNhcmRNb2RhbEJ1dHRvbiIsImF2YXRhck1vZGFsQnV0dG9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJhdmF0YXJJbWFnZSIsImVkaXRQcm9maWxlTW9kYWwiLCJhdmF0YXJFZGl0TW9kYWwiLCJjYXJkTW9kYWwiLCJwcmV2aWV3TW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJmb3JtcyIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uIiwiY2FyZEZvcm0iLCJjYXJkU3VibWl0QnV0dG9uIiwiY2FyZE5hbWVJbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJwcmV2aWV3TW9kYWxJbWFnZUVsIiwicHJldmlld01vZGFsQ2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZUVzY0tleSIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJyZW5kZXJDYXJkIiwiaXRlbSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNhcmRFbGVtZW50IiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsZW1lbnQiLCJjYXJkSW1hZ2VFbGVtZW50IiwiY2FyZExpa2VCdXR0b24iLCJjYXJkRGVsZXRlQnV0dG9uIiwibGluayIsImFsdCIsInRvZ2dsZSIsImdldENhcmRFbGVtZW50IiwiYnV0dG9uIiwiY2xvc2VzdCIsInRhcmdldCIsInZhbHVlIiwicmVzZXRWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJuZXdOYW1lIiwibmV3QWJvdXQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImlucHV0VmFsdWVzIiwidHJpbSIsInJlc2V0IiwiYWxlcnQiLCJjYXJkcyIsInVzZXIiLCJjYXJkIiwiYXZhdGFyIiwic2V0RXZlbnRMaXN0ZW5lciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsImZvcm0iLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=